var speciesData = {
    "Alligator": ["Alfonso", "Alli", "Boots", "Del", "Drago", "Gayle", "Liz", "Roswell", "Sly"],
    "Anteater": ["Anabelle", "Annalisa", "Antonio", "Cyrano", "Lulu (anteater)", "Nosegay", "Olaf", "Pango", "Snooty", "Zoe"],
    "Bear": ["Beardo", "Charlise", "Chow", "Curt", "Dozer", "Grizzly", "Groucho", "Ike", "Klaus", "Megan", "Nate", "Paula", "Pinky", "Teddy", "Tutu", "Ursala"],
    "Bird": ["Ace", "Admiral", "Anchovy", "Flash", "Jacob", "Jacques", "Jay", "Jitters", "Joe", "Lucha", "Madam Rosa", "Medli", "Midge", "Otis", "Peck", "Piper", "Robin", "Shoukichi", "Sparro", "Twiggy", "Twirp"],
    "Bull": ["Angus", "Chuck", "Coach", "Oxford", "Rodeo", "Stu", "T-Bone", "Vic", "Weldon"],
    "Cat": ["Ankha", "Bob", "Felicity", "Felyne", "Kabuki", "Katt", "Kid Cat", "Kiki", "Kitty", "Lolly", "Meow", "Merry", "Mitzi", "Moe", "Monique", "Olivia", "Pierre", "Punchy", "Purrl", "Raymond", "Rosie", "Rudy", "Stinky", "Tabby", "Tangy", "Tom"],
    "Chicken": ["Ava", "Becky", "Benedict", "Betty", "Broffina", "Egbert", "Goose", "Hank", "Hector", "Ken", "Knox", "Leigh", "Plucky", "Rhoda"],
    "Cow": ["Belle", "Bessie", "Carrot", "Naomi", "Norma", "Patty", "Petunia", "Tipper"],
    "Cub": ["Aisle", "Barold", "Bluebear", "Cheri", "Chester", "Cupcake", "Judy", "June", "Kody", "Maple", "Marty", "Murphy", "Olive", "Pekoe", "Poko", "Poncho", "Pudge", "Stitches", "Tammy", "Vladimir"],
    "Deer": ["Bam", "Beau", "Bruce", "Chelsea", "Deirdre", "Diana", "Erik", "Fauna", "Fuchsia", "Lopez", "Shino", "Zell"],
    "Dog": ["Bea", "Benjamin", "Biskit", "Bones", "Bow", "Butch", "Cherry", "Cookie", "Daisy", "Frett", "Goldie", "Lucky", "Mac", "Maddie", "Marcel", "Masa", "Megumi", "Portia", "Shep", "Walker"],
    "Duck": ["Bill", "Deena", "Derwin", "Drake", "Freckles", "Fruity", "Gloria", "Mallary", "Miranda", "Molly", "Pate", "Pompom", "Quillson", "Scoot", "Shinabiru", "Weber"],
    "Eagle": ["Amelia", "Apollo", "Avery", "Buzz", "Celia", "Frank", "Keaton", "Pierce", "Quetzal", "Quinn", "Sterling"],
    "Elephant": ["Axel", "Big Top", "Chai", "Cyd", "Dizzy", "Elina", "Ellie", "Eloise", "Margie", "Opal", "Paolo", "Tia", "Tucker"],
    "Frog": ["Camofrog", "Cousteau", "Croque", "Diva", "Drift", "Emerald", "Frobert", "Gigi", "Henry", "Huck", "Jambette", "Jeremiah", "Lily", "Prince", "Puddles", "Raddle", "Ribbot", "Sunny", "Tad", "Wart Jr"],
    "Goat": ["Billy", "Chevre", "Gruff", "Iggy", "Kidd", "Nan", "Pashmina", "Sherb", "Sven", "Velma"],
    "Gorilla": ["Al", "Boone", "Boyd", "Cesar", "Hans", "Jane", "Louie", "Peewee", "Rilla", "Rocket", "Violet", "Yodel"],
    "Hamster": ["Apple", "Clay", "Flurry", "Graham", "Hamlet", "Hamphrey", "Holden", "Marlo", "Rodney", "Soleil"],
    "Hippo": ["Bertha", "Biff", "Bitty", "Bubbles", "Clara", "Harry", "Hippeux", "Lulu (hippo)", "Rocco", "Rollo"],
    "Horse": ["Annalise", "Buck", "Cleo", "Clyde", "Colton", "Ed", "Elmer", "Epona", "Filly", "Julian", "Papi", "Peaches", "Reneigh", "Roscoe", "Savannah", "Victoria", "Winnie"],
    "Kangaroo": ["Astrid", "Carrie", "Kitt", "Koharu", "Marcie", "Marcy", "Mathilda", "Rooney", "Sylvia", "Valise", "Walt"],
    "Koala": ["Alice", "Canberra", "Eugene", "Faith", "Gonzo", "Huggy", "Lyman", "Melba", "Ozzie", "Sydney", "Yuka"],
    "Lion": ["Aziz", "Bud", "Elvis", "Juubei", "Leopold", "Lionel", "Mott", "Rex", "Rory"],
    "Monkey": ["Champ", "Deli", "Elise", "Flip", "Monty", "Nana", "Shari", "Simon", "Tammi", "Tiansheng"],
    "Mouse": ["Anicotti", "Bella", "Bettina", "Bree", "Broccolo", "Candi", "Carmen (mouse)", "Chadder", "Chico", "Dora", "Flossie", "Greta", "Limberg", "Moose", "Penelope", "Penny", "Petri", "Rizzo", "Rod", "Samson"],
    "Octopus": ["Cephalobot", "Inkwell", "Marina", "Octavian", "Zucker"],
    "Ostrich": ["Blanche", "Cranston", "Flora", "Gladys", "Julia", "Nindori", "Phil", "Phoebe", "Queenie", "Rio", "Sandy", "Sprocket"],
    "Penguin": ["Analog", "Aurora", "Boomer", "Chabwick", "Cube", "Flo", "Friga", "Gwen", "Hopper", "Iggly", "Puck", "Roald", "Sprinkle", "Tex", "Wade"],
    "Pig": ["Agnes", "Boris", "Chops", "Cobb", "Curly", "Gala", "Ganon", "Hambo", "Hugh", "Kevin", "Lucy", "Maggie", "Pancetti", "Peggy", "Pigleg", "Rasher", "Spork", "Sue E", "Truffles"],
    "Rabbit": ["Bonbon", "Bunnie", "Carmen (rabbit)", "Chrissy", "Claude", "Coco", "Cole", "Doc", "Dotty", "Francine", "Gabi", "Gaston", "Genji", "Hopkins", "Mira", "O'Hare", "Pippy", "Ruby", "Sasha", "Snake", "Tiffany", "Toby"],
    "Rhino": ["Azalea", "Hornsby", "Merengue", "Patricia", "Renee", "Rhonda", "Spike", "Tank", "Tiara"],
    "Sheep": ["Baabara", "Cashmere", "Curlos", "Dom", "Etoile", "Eunice", "Frita", "Gen", "Muffy", "Pietro", "Stella", "Timbra", "Vesta", "Wendy", "Willow", "Woolio"],
    "Squirrel": ["Agent S", "Blaire", "Cally", "Caroline", "Cece", "Filbert", "Hazel", "Ione", "Kit", "Marshal", "Mint", "Nibbles", "Peanut", "Pecan", "Poppy", "Ricky", "Sally", "Sheldon", "Static", "Sylvana", "Tasha", "Viche"],
    "Tiger": ["Bangle", "Bianca", "Claudia", "Leonardo", "Rolf", "Rowan", "Tybalt"],
    "Wolf": ["Audie", "Chief", "Dobie", "Fang", "Freya", "Kyle", "Lobo", "Skye", "Tarou", "Vivian", "Wolf Link", "Whitney", "Wolfgang"]
}

var numRows = 5;
var numColumns = 7;
var totalCells = numRows * numColumns;
var table = document.createElement('table');

document.addEventListener("DOMContentLoaded", function() {
    // generate table cells
    function generateTD(species, villagers) {
        var td = document.createElement('td');
        var div = document.createElement('div');
        div.classList.add('villagerContainer');

        // species name
        var speciesName = document.createElement('span');
        speciesName.classList.add('species');
        var speciesText = document.createTextNode(species);
        speciesName.appendChild(speciesText);
        div.appendChild(speciesName);
        div.appendChild(document.createElement('br'));
    
        // villager image
        var img = document.createElement('img');
        img.classList.add('villagerImage');
        img.src = 'images/' + villagers[0].toLowerCase() + '.png';
        img.alt = villagers[0];
        div.appendChild(img);
        div.appendChild(document.createElement('br'));

        // dropdown menu
        var select = document.createElement('select');
        select.classList.add('villagerSelect');
        villagers.forEach(function(villager) {
            var option = document.createElement('option');
            option.value = villager.toLowerCase();
            option.textContent = villager;
            select.appendChild(option);
        });
    
        div.appendChild(select);
        td.appendChild(div);

        // for updating and saving the image
        select.addEventListener('change', function() {
            updateImageAndSaveSelection(species, this);
        });

        // get saved selections from local storage
        var savedSelections = JSON.parse(localStorage.getItem('villagerSelections')) || {};
        var selectedVillager = savedSelections[species];
        if (selectedVillager) {
            select.value = selectedVillager;

            select.dispatchEvent(new Event('change'));
        }

        return td;
    }

    // update and save choices
    function updateImageAndSaveSelection(species, select) {
        // image update
        var selectedVillager = select.value;
        var container = select.closest('.villagerContainer');
        var imageElement = container.querySelector('.villagerImage');
        imageElement.src = 'images/' + selectedVillager.toLowerCase() + '.png';
        imageElement.alt = selectedVillager;

        // save to local storage
        saveSelection(species, selectedVillager);
    }

    function saveSelection(species, selectedVillager) {
        var savedSelections = JSON.parse(localStorage.getItem('villagerSelections')) || {};
        savedSelections[species] = selectedVillager;
        localStorage.setItem('villagerSelections', JSON.stringify(savedSelections));

        // console.log('Selection saved to localStorage:', savedSelections);
    }

    // generate table
    function generateTable() {
        var count = 0;
        
        for (var i = 0; i < numRows; i++) {
            var row = document.createElement('tr');
            for (var j = 0; j < numColumns; j++) {
                var species = Object.keys(speciesData)[count];
                var td = generateTD(species, speciesData[species]);
                row.appendChild(td);
                count++;
                if (count >= totalCells) break;
            }
            table.appendChild(row);
        }
        
        document.body.appendChild(table);
    }

    generateTable();

    // hide mobile message
    function hideMessage() {
        var mobileMessage = document.getElementById('mobileMessage');
        mobileMessage.style.display = 'none';
    }

    document.addEventListener('DOMContentLoaded', function() {
        var hideButton = document.getElementById('hideButton');
        if (hideButton) {
            hideButton.addEventListener('click', hideMessage);
        }
    });
});